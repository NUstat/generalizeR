<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="generalizeR">
<title>generalizeR Tutorial • generalizeR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="generalizeR Tutorial">
<meta property="og:description" content="generalizeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">generalizeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/generalizeR_tutorial.html">generalizeR Tutorial</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/NUstat/generalizeR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="generalizeR_tutorial_files/kePrint-0.0.1/kePrint.js"></script><link href="generalizeR_tutorial_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>generalizeR Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NUstat/generalizeR/blob/HEAD/vignettes/generalizeR_tutorial.Rmd" class="external-link"><code>vignettes/generalizeR_tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>generalizeR_tutorial.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Welcome to the generalizeR! This package is designed to guide
education researchers through:</p>
<ul>
<li>Using important features of their inference population to stratify
units</li>
<li>Developing a recruitment plan for a future evaluation</li>
<li>Assessing the generalizability of a completed evaluation</li>
</ul>
<p>Note that it is possible to use the package at either end of the
sampling process: you can start at the beginning and use the package to
obtain a stratified sample, or you can start at the end with your
previously obtained sample data and assess its generalizability.</p>
</div>
<div class="section level2">
<h2 id="step-1-stratify">Step 1: Stratify<a class="anchor" aria-label="anchor" href="#step-1-stratify"></a>
</h2>
<div class="section level3">
<h3 id="guided">Guided<a class="anchor" aria-label="anchor" href="#guided"></a>
</h3>
<p>The <code><a href="../reference/stratify.html">stratify()</a></code> function defaults to ‘guided’ mode,
meaning that it prints text throughout and prompts the user to enter
information with a question-and-answer format. This is intentional, in
part to mimic the nature of <a href="http://thegeneralizer.org/" class="external-link uri">http://thegeneralizer.org/</a> and in part because we intend
for this R package to be as accessible as possible for people with
limited R experience.</p>
<p>Users who are running <code><a href="../reference/stratify.html">stratify()</a></code> multiple times, who are
familiar with R, or who simply dislike the guided feature can turn it
off by using the argument ‘guided = FALSE’. If they do so, however, they
must be sure to specify values for all the other function arguments, as
those would otherwise be obtained from user input later.</p>
<p>This tutorial will follow a hypothetical example.</p>
</div>
<div class="section level3">
<h3 id="filtering-the-inference-population">Filtering the Inference Population<a class="anchor" aria-label="anchor" href="#filtering-the-inference-population"></a>
</h3>
<p>Suppose we are a team of education researchers who want to test the
effect of an intervention on SAT scores. We have somewhat limited
resources, so we plan on using a sample size of 40 schools. We want to
estimate the average effect of our intervention in Texas charter high
schools. Thus, our <strong>inference population</strong> consists of
<em>all Texas charter high schools</em>. Previous literature suggests
that gender, minority status, and social class might affect gaps in
achievement, so we select a few <strong>stratifying variables</strong> –
<em>percentage female</em>, <em>percentage black</em>, and
<em>percentage free and reduced lunch</em>. We also think school size
might result in treatment differences, so we include the <em>total
school size</em> as well.</p>
<p>Since we are working with high schools, we can use the Common Core
database provided in this package. For information on each of the
columns and the source of the data, run <code><a href="../reference/cc.html">?cc</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cc</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 98,563 × 43</span></span></span>
<span><span class="co">##        ncessch sch_name     st    mstreet1 mcity phone website lea_name sch_type</span></span>
<span><span class="co">##          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">500</span>870 Ala Avenue … AL    600 E A… Albe… (256… http:/… Albertv…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">500</span>871 Albertville… AL    402 E M… Albe… (256… http:/… Albertv…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">500</span>879 Evans Elem … AL    901 W M… Albe… (256… http:/… Albertv…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">500</span>889 Albertville… AL    1100 Ho… Albe… (256… http:/… Albertv…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">501</span>616 Big Spring … AL    257 Cou… Albe… (256… http:/… Albertv…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">502</span>150 Albertville… AL    1100 Ho… Albe… (256… http:/… Albertv…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">600</span>193 Kate Duncan… AL    6077 Ma… Grant (256… http:/… Marshal…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">600</span>872 Asbury Sch   AL    1990 As… Albe… (256… http:/… Marshal…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">600</span>876 Claysville … AL    140 Cla… Gunt… (256… http:/… Marshal…        1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">10</span>000<span style="text-decoration: underline;">600</span>877 Douglas Ele… AL    P O Box… Doug… (256… http:/… Marshal…        1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 98,553 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 34 more variables: g_pk_offered &lt;chr&gt;, g_kg_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_1_offered &lt;chr&gt;, g_2_offered &lt;chr&gt;, g_3_offered &lt;chr&gt;, g_4_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_5_offered &lt;chr&gt;, g_6_offered &lt;chr&gt;, g_7_offered &lt;chr&gt;, g_8_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_9_offered &lt;chr&gt;, g_10_offered &lt;chr&gt;, g_11_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_12_offered &lt;chr&gt;, level &lt;chr&gt;, leaid &lt;int&gt;, charter &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   titlei_status_text &lt;chr&gt;, magnet_text &lt;chr&gt;, nslp_status &lt;chr&gt;, …</span></span></span></code></pre>
<p>By looking at the <code>st</code> column, we can already see a
problem here. The data frame contains schools from all states in the US,
but we are interested in a much narrower inference population.
Therefore, there is some filtering we must do first.</p>
<p>To identify Texas schools, we can select those rows with
<code>st</code> equal to <code>TX</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_pop</span> <span class="op">&lt;-</span> <span class="va">cc</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">st</span> <span class="op">==</span> <span class="st">"TX"</span><span class="op">)</span></span></code></pre></div>
<p>To filter out the non-charter schools, we can use the variable in our
data frame called <code>charter</code> that takes on the value of 0 for
non-charter schools and 1 for charter schools. Finally, to select high
schools (which almost always include grades 9 to 12), we can use one of
the grade indicator variables, say <code>g_10_offered</code>. After
combining all of these filters, we get:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inference_pop</span> <span class="op">&lt;-</span> <span class="va">cc</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">st</span> <span class="op">==</span> <span class="st">"TX"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">charter</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">g_10_offered</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="va">inference_pop</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 330 × 43</span></span></span>
<span><span class="co">##         ncessch sch_name    st    mstreet1 mcity phone website lea_name sch_type</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">480</span>000<span style="text-decoration: underline;">407</span>173 POR VIDA A… TX    1135 MI… SAN … (210… <span style="color: #949494;">"</span>http:… POR VID…        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">480</span>000<span style="text-decoration: underline;">409</span>116 CORPUS CHR… TX    1135 MI… SAN … (361… <span style="color: #949494;">"</span>http:… POR VID…        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="text-decoration: underline;">480</span>000<span style="text-decoration: underline;">409</span>460 CESAR E CH… TX    3701 MU… CORP… (361… <span style="color: #949494;">"</span>http:… POR VID…        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">407</span>174 GEORGE GER… TX    6944 SU… SAN … (210… <span style="color: #949494;">""</span>      GEORGE …        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">607</span>239 DALLAS CAN… TX    4621 RO… DALL… (214… <span style="color: #949494;">"</span>http:… TEXANS …        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">607</span>847 DALLAS CAN… TX    325 W 1… DALL… (214… <span style="color: #949494;">"</span>http:… TEXANS …        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">607</span>910 HOUSTON CA… TX    325 W 1… DALL… (214… <span style="color: #949494;">"</span>http:… TEXANS …        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">608</span>434 SAN ANTONI… TX    325 W 1… DALL… (210… <span style="color: #949494;">"</span>http:… TEXANS …        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">608</span>908 FORT WORTH… TX    6220 WE… FORT… (817… <span style="color: #949494;">"</span>http:… TEXANS …        4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">480</span>001<span style="text-decoration: underline;">609</span>028 FORT WORTH… TX    325 W 1… DALL… (817… <span style="color: #949494;">"</span>http:… TEXANS …        4</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 320 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 34 more variables: g_pk_offered &lt;chr&gt;, g_kg_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_1_offered &lt;chr&gt;, g_2_offered &lt;chr&gt;, g_3_offered &lt;chr&gt;, g_4_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_5_offered &lt;chr&gt;, g_6_offered &lt;chr&gt;, g_7_offered &lt;chr&gt;, g_8_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_9_offered &lt;chr&gt;, g_10_offered &lt;chr&gt;, g_11_offered &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   g_12_offered &lt;chr&gt;, level &lt;chr&gt;, leaid &lt;int&gt;, charter &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   titlei_status_text &lt;chr&gt;, magnet_text &lt;chr&gt;, nslp_status &lt;chr&gt;, …</span></span></span></code></pre>
<p>The size of our inference population has dropped from over 98,000
schools to about 350 schools. It now only includes Texas charter high
schools (or schools that offer 10th grade).</p>
</div>
<div class="section level3">
<h3 id="running-the-function">Running the Function<a class="anchor" aria-label="anchor" href="#running-the-function"></a>
</h3>
<p>We are now ready to run <code><a href="../reference/stratify.html">stratify()</a></code> on our inference
population. We enter:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stratify.html">stratify</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inference_pop</span><span class="op">)</span></span></code></pre></div>
<p>We are greeted with the following:</p>
<p><img src="new_figures_091922/stratify_fig_1_v2.png" width="550"></p>
</div>
<div class="section level3">
<h3 id="selecting-the-id-variable">Selecting the ID Variable<a class="anchor" aria-label="anchor" href="#selecting-the-id-variable"></a>
</h3>
<p>The above prompt requires us to enter the name of the ID variable we
wish to use. We enter the name of the column that contains the unique
NCES school IDs in the CCD database – <code>ncessch</code>.</p>
<p><img src="new_figures_091922/stratify_fig_2_v2.png" width="550"></p>
<p>We then receive a message informing us that <code><a href="../reference/stratify.html">stratify()</a></code>
has converted all the character variables in our data frame to factor
variables. This means some factor variables will have a large number of
levels if their original character versions had many distinct
observations. We are also told a table displaying an overview of the
variables in our data frame has been printed in the Viewer pane. A
preview of that same table is shown below. In general, whenever a table
is printed to the console, there will be one printed in the Viewer pane
as well.</p>
<table style="NAborder-bottom: 0; margin-left: auto; margin-right: auto;" class="table table table-striped table-hover table-condensed">
<caption>
Variable Overview
</caption>
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Levels
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
sch_name
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
329
</td>
</tr>
<tr>
<td style="text-align:left;">
st
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
mstreet1
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
244
</td>
</tr>
<tr>
<td style="text-align:left;">
mcity
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
84
</td>
</tr>
<tr>
<td style="text-align:left;">
phone
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
307
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> Only the first 5 rows of the table are shown in this
tutorial.
</td>
</tr>
</tfoot>
</table>
</div>
<div class="section level3">
<h3 id="selecting-the-stratification-variables">Selecting the Stratification Variables<a class="anchor" aria-label="anchor" href="#selecting-the-stratification-variables"></a>
</h3>
<p>Next we receive a prompt asking us to select our stratification
variables and a menu showing us all the variables available in our
dataset. We are also given a warning that we must select at least two
variables and we can’t choose any factor variables containing more than
4 levels. These restrictions are put in place to prevent errors and
ensure the stratification process goes smoothly. If we wish to use a
factor variable with more than 4 levels for stratification, we must
first exit <code><a href="../reference/stratify.html">stratify()</a></code> and re-code our desired factor levels
from that variable as indicator variables within our data frame (the
package <code>fastDummies</code> may be of use).</p>
<p>When choosing covariates, we must ensure that we do not use columns
that contain only one value. In this case, we cannot use
<code>charter</code> as a covariate, as all the schools in our current
dataset are charter schools and every value of <code>charter</code> is
1. Also we must ensure that we do not use columns that are linearly
dependent. An example of this is if the sum of two columns is a column
itself. <code><a href="../reference/stratify.html">stratify()</a></code> will give an error if either of these
cases happens.</p>
<p><img src="new_figures_091922/stratify_fig_3_v2.png" width="700"></p>
<p>For our stratifying variables of interest, we have chosen
<code>pct_female</code>, <code>pct_black_or_african_american</code>,
<code>pct_free_and_reduced_lunch</code>, and <code>total</code>. We
enter: <code>29 32 38 42</code>. The function prints out a list of these
variables with their names highlighted in blue, as well as a table
displaying each variable’s type and number of levels. This is done so we
can look them over, confirm what we selected, and make sure the
variables are the types we expected. Since these results seem
reasonable, we indicate that they are correct by entering
<code>1</code>.</p>
<p><img src="new_figures_091922/stratify_fig_4_v2.png" width="550"></p>
</div>
<div class="section level3">
<h3 id="missing-observations">Missing Observations<a class="anchor" aria-label="anchor" href="#missing-observations"></a>
</h3>
<p>We are now shown a table (also available in the Viewer pane) that
breaks down how many missing observations each variable contains,
including our id variable <code>ncessch</code>. These observations will
be dropped from the inference population before the stratification is
performed.</p>
<p><img src="new_figures_091922/stratify_fig_5_v2.png" width="550"></p>
</div>
<div class="section level3">
<h3 id="descriptive-statistics">Descriptive Statistics<a class="anchor" aria-label="anchor" href="#descriptive-statistics"></a>
</h3>
<p>Next, the function prints out the descriptive statistics of the
stratification variables chosen, both categorical and continuous. In
this case, all the variables are continuous. Plots of the variables –
histograms or bar charts, as appropriate – are generated and displayed
one at a time.</p>
<p><img src="new_figures_091922/stratify_fig_6_v2.png" width="550"></p>
<p><img src="generalizeR_tutorial_files/figure-html/unnamed-chunk-12-1.png" width="1458.33333333333"></p>
</div>
<div class="section level3">
<h3 id="choosing-the-number-of-strata">Choosing the Number of Strata<a class="anchor" aria-label="anchor" href="#choosing-the-number-of-strata"></a>
</h3>
<p>Now we are ready to choose the number of strata in which to divide
our population. <code><a href="../reference/stratify.html">stratify()</a></code> prints some information, similar
to that presented by the <a href="https://www.thegeneralizer.org/" class="external-link">Generalizer Web application</a>,
explaining what the choice represents and giving us some guidance. While
choosing more strata is generally better in terms of generalizability,
the practical demand placed on the sampling process increases with the
number of strata, because units must be sampled from each stratum.</p>
<p>Since we are only planning on using a sample size of 40 schools,
we’ll try a smaller number – 4 strata:</p>
<p><img src="new_figures_091922/stratify_fig_7_v2.png" width="550"></p>
<p>The process of stratifying can take some time. If the function were
to run silently, users might fear that R had frozen and quit. As a sort
of progress bar, we have turned on “verbose” mode for the clustering
process, which prints out the within-cluster sum of squares at each
iteration until the stratifying process converges:</p>
<p><img src="new_figures_091922/stratify_fig_8_v2.png" width="550"></p>
</div>
<div class="section level3">
<h3 id="understanding-the-results">Understanding the Results<a class="anchor" aria-label="anchor" href="#understanding-the-results"></a>
</h3>
<div class="section level4">
<h4 id="stratification-review">Stratification Review<a class="anchor" aria-label="anchor" href="#stratification-review"></a>
</h4>
<p>The results begin with a brief review of the stratification process.
We are informed of the stratification variables, the observations
dropped due to missing data, the population size (after missing
observations have been dropped), the number of strata, and the
proportion of variation in the population explained by the strata. In
this case, that proportion was about 66%. Increasing the number of
strata would increase the percentage explained and result in more
homogeneous strata but would also require more resources during study
implementation.</p>
<p><img src="new_figures_091922/stratify_fig_9_v2.png" width="550"></p>
</div>
<div class="section level4">
<h4 id="covariate-statistics">Covariate Statistics<a class="anchor" aria-label="anchor" href="#covariate-statistics"></a>
</h4>
<p><code><a href="../reference/stratify.html">stratify()</a></code> then provides us with a table of the
within-stratum means and standard deviations for each of the stratifying
variables, as well as a count of the total number of units in each
stratum.</p>
<p><img src="new_figures_091922/stratify_fig_10_v2.png" width="550"></p>
<p>A similar table is printed in the Viewer pane:</p>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
Covariate Statistics by Stratum
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Stratum 1<br>n = 46
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Stratum 2<br>n = 161
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Stratum 3<br>n = 87
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Stratum 4<br>n = 30
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Population<br>n = 324
</div>
</th>
</tr>
<tr>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Variable
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Mean
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Standard Deviation
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Mean
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Standard Deviation
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Mean
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Standard Deviation
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Mean
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Standard Deviation
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Mean
</th>
<th style="text-align:center;position: sticky; top:0; background-color: #FFFFFF;">
Standard Deviation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
total
</td>
<td style="text-align:center;">
333.804
</td>
<td style="text-align:center;">
466.237
</td>
<td style="text-align:center;">
433.925
</td>
<td style="text-align:center;">
316.029
</td>
<td style="text-align:center;">
434.218
</td>
<td style="text-align:center;">
451.636
</td>
<td style="text-align:center;">
362.300
</td>
<td style="text-align:center;">
1074.626
</td>
<td style="text-align:center;">
413.157
</td>
<td style="text-align:center;">
489.103
</td>
</tr>
<tr>
<td style="text-align:center;">
pct_black_or_african_american
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.141
</td>
<td style="text-align:center;">
0.076
</td>
<td style="text-align:center;">
0.081
</td>
<td style="text-align:center;">
0.116
</td>
<td style="text-align:center;">
0.114
</td>
<td style="text-align:center;">
0.525
</td>
<td style="text-align:center;">
0.279
</td>
<td style="text-align:center;">
0.163
</td>
<td style="text-align:center;">
0.191
</td>
</tr>
<tr>
<td style="text-align:center;">
pct_female
</td>
<td style="text-align:center;">
0.480
</td>
<td style="text-align:center;">
0.164
</td>
<td style="text-align:center;">
0.522
</td>
<td style="text-align:center;">
0.052
</td>
<td style="text-align:center;">
0.533
</td>
<td style="text-align:center;">
0.098
</td>
<td style="text-align:center;">
0.324
</td>
<td style="text-align:center;">
0.299
</td>
<td style="text-align:center;">
0.501
</td>
<td style="text-align:center;">
0.138
</td>
</tr>
<tr>
<td style="text-align:center;">
pct_free_and_reduced_lunch
</td>
<td style="text-align:center;">
0.857
</td>
<td style="text-align:center;">
0.106
</td>
<td style="text-align:center;">
0.789
</td>
<td style="text-align:center;">
0.133
</td>
<td style="text-align:center;">
0.293
</td>
<td style="text-align:center;">
0.154
</td>
<td style="text-align:center;">
0.805
</td>
<td style="text-align:center;">
0.276
</td>
<td style="text-align:center;">
0.667
</td>
<td style="text-align:center;">
0.275
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="heat-map">Heat Map<a class="anchor" aria-label="anchor" href="#heat-map"></a>
</h4>
<p>The function also prints a heat map:</p>
<p><img src="generalizeR_tutorial_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<p>Each column of the heat map corresponds to a stratum. We can read the
map by going down the columns, assessing each stratum in relation to the
population. Remember that the goal is to sample independently within
each stratum in order to obtain a sample that is representative of the
population as a whole. To that end, each stratum has been made as
homogeneous as possible within itself (i.e. the within-stratum variances
have been minimized) while also maintaining as much heterogeneity as
possible across strata (i.e. the between-stratum variance has been
maximized).</p>
<p>Looking at the first column, we see that Stratum 2 contains 161 Texas
charter high schools. These schools are:</p>
<ul>
<li>close to the population mean in number of students (about 430),</li>
<li>above the population mean in the percentage of students on free or
reduced lunch (80%),</li>
<li>close to the population mean in percentage of female students
(50%),</li>
<li>and below the population mean in percentage of black students
(10%).</li>
</ul>
<p>The other columns may be interpreted in exactly the same manner.</p>
<p>(Users may wonder why the shade of red for the bottom left and bottom
right cells differs when both seem to have a mean of 10%. This is
because of the scale of the variable, the size of the population mean,
and rounding.)</p>
<p>After reading the results, we have the opportunity to try out
different numbers of strata, as seen in the prompt below.</p>
<p><img src="stratify_try_again.png" width="550"></p>
<p>If we wish to try different strata, we enter 1, as seen in the image,
then enter the number of strata we wish to try. All of the same
statistics will be printed again for the different number of strata. We
may try as many different strata as we like. Only the last strata will
be saved in the <code>strat_output</code> object. In this case, I will
stick with four strata.</p>
</div>
<div class="section level4">
<h4 id="summary-and-print">Summary and Print<a class="anchor" aria-label="anchor" href="#summary-and-print"></a>
</h4>
<p>If we wish to look at the results of <code><a href="../reference/stratify.html">stratify()</a></code> again,
we can run the following code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">strat_output</span><span class="op">)</span></span></code></pre></div>
<p>Note that <code>strat_output</code> is the name we have assigned to
our <code>stratify_object</code> in this example; users should replace
it with their own name they have chosen.</p>
<p>There is also an option to print our <code>stratify_object</code>.
Doing so yields:</p>
<!--**TODO: Fix `stratify_object` `print()` method**-->
<p><img src="stratify_fig_12.png" width="550"></p>
<p>We have finished the stratifying process!</p>
</div>
</div>
<div class="section level3">
<h3 id="unguided">Unguided<a class="anchor" aria-label="anchor" href="#unguided"></a>
</h3>
<p>We highly suggest that you only use the unguided version after you
have used the guided version multiple times and feel that you have a
clear understanding of what the function does. If you want to use the
guided version, but are uncertain about what each argument is supposed
to be, please run <code><a href="../reference/stratify.html">?stratify</a></code> in the console, or check the
reference page for the function.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-2-recruit">Step 2: Recruit<a class="anchor" aria-label="anchor" href="#step-2-recruit"></a>
</h2>
<div class="section level3">
<h3 id="guided-1">Guided<a class="anchor" aria-label="anchor" href="#guided-1"></a>
</h3>
<p>Now that we have separated our inference population into 4 strata,
our next goal is to sample units from each stratum in such a way that
the overall sample will be representative of the entire population. We
can accomplish this task using the <code><a href="../reference/recruit.html">recruit()</a></code> function.</p>
<p>Like <code><a href="../reference/stratify.html">stratify()</a></code>, <code><a href="../reference/recruit.html">recruit()</a></code> is guided by
default; we can simply set <code>guided = FALSE</code> to turn this
option off if we choose, but we must specify values for the other
function arguments instead.</p>
<p>Since we assigned the results of <code><a href="../reference/stratify.html">stratify()</a></code> to an
object, that object can then be passed directly into
<code><a href="../reference/recruit.html">recruit()</a></code>, like so:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recruit.html">recruit</a></span><span class="op">(</span><span class="va">strat_output</span><span class="op">)</span></span></code></pre></div>
<p>We are immediately greeted with the following welcome message:</p>
<p><img src="new_figures_091922/recruit_fig_1_v2.png" width="550"></p>
<p>After pressing the return key, we see:</p>
<p><img src="new_figures_091922/recruit_fig_2_v2.png" width="550"></p>
<p>Our desired sample size is 40 schools, so we enter ‘40’ for the
number of units we wish to recruit. The function then generates a
recruitment list for each stratum. Each row in a stratum’s recruitment
list corresponds to a different unit in the stratum, and the units have
been ranked in ascending order of their <a href="https://en.wikipedia.org/wiki/Mahalanobis_distance" class="external-link">Mahalanobis
distances</a> from the mean vector of the stratifying variables. The
idea is that the units with the smallest Mahalanobis distances are most
likely to be “representative” of the population and so should be chosen
first to be part of the sample.</p>
<p><img src="new_figures_091922/recruit_fig_3_v2.png" width="550"></p>
<p>Next, the function prints a recruitment table that tells us how many
units we should recruit from each stratum. It arrives at these numbers
by multiplying the sampling proportion (which is equal to the ratio of
the stratum size to the total population size) for each stratum by the
desired sample size, in this case 40.</p>
<p>Here is what the recruitment table looks like in the Viewer pane.</p>
<p><img src="recruit_table.png" width="550"></p>
<p>This means that our recruitment plan should be to recruit 20 schools
from Stratum 1, 4 from Stratum 2, 5 from Stratum 3, and 11 from Stratum
4.</p>
<p>If a strata is very small (e.g. has only one or two units), then it
is possible for <code>recruit</code> to choose zero units from that
strata. If this happens, then your chosen strata are likely not ideal,
and you should go through the stratification process again.</p>
<p>The function then asks us if we want to save the recruitment lists as
csv files.</p>
<p><img src="recruit_fig_01.png" width="550"></p>
<p>Upon entering ‘1’ to indicate ‘Yes’, the lists are automatically
saved to your working directory. This also happens in the unguided
function if we set <code>save_as_csv = TRUE</code>.</p>
<p><img src="new_figures_091922/recruit_fig_6_v2.png" width="550"></p>
<p>Lastly, the function reminds us that the recruitment lists can also
be accessed from its output, provided that it has been stored in an
object. You can also see the table showing the strata and the number of
units recruited any time by running <code>print(rec_output)</code>.</p>
<p>We have finished the recruitment process!</p>
</div>
<div class="section level3">
<h3 id="unguided-1">Unguided<a class="anchor" aria-label="anchor" href="#unguided-1"></a>
</h3>
<p>We highly suggest that you only use the unguided version after you
have used the guided version multiple times and feel that you have a
clear understanding of what the function does. If you want to use the
guided version, but are uncertain about what each argument is supposed
to be, please run <code><a href="../reference/recruit.html">?recruit</a></code> in the console or check the
reference page for <code>recruit</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-3-assess">Step 3: Assess<a class="anchor" aria-label="anchor" href="#step-3-assess"></a>
</h2>
<div class="section level3">
<h3 id="guided-2">Guided<a class="anchor" aria-label="anchor" href="#guided-2"></a>
</h3>
<p>The <code><a href="../reference/assess.html">assess()</a></code> function reports generalizability for your
sample. A generalizability index (between 0 and 1) is a global measure
of similarity between the sample and population for a defined set of
covariates. You can multiply by 100 to get a percentage value: for
instance, a generalizability index of 0.8 means the sample is 80%
similar to the population on the selected covariates. We highly suggest
running <code><a href="../reference/assess.html">assess()</a></code> <strong>before</strong> beginning any
research studies so that you can be confident you have a representative
sample.</p>
<p>Here are some rules of thumb for interpreting the generalizability
index:</p>
<ul>
<li><p>Very High: 1.00 ≥ B ≥ 0.90;</p></li>
<li><p>High: 0.90 &gt; B ≥ 0.80;</p></li>
<li><p>Medium: 0.80 &gt; B ≥ 0.50;</p></li>
<li><p>Low: B &lt; 0.50.</p></li>
</ul>
<p>From Tipton (2014):</p>
<blockquote>
<p>Here “very high” generalizability means that the experimental sample
is “like” a random sample from the population of interest. When the
sample is not like the population, however, reweighting can be used to
estimate a useful result when the sample has “high” generalizability.
This means that the reweighted estimate of PATE is likely to be close to
conditionally unbiased (assuming that the ignorability condition has
been met) and that the sample is sufficiently similar to the population
that this reweighting will result in only a small increase in standard
errors. In contrast, when a sample is considered to have “medium”
generalizability, while reweighting is possible, as a result of coverage
errors or overlap problems, the reweighted estimator will contain bias
and/or the inflation to the standard errors could be large. This means
that results may not be quite as useful. Finally, for those with “low”
generalizability, the sample and population are considered sufficiently
different that no amount of reweighting will produce a useful estimate
of the average treatment effect for the population. In some cases, this
is because the amount of bias that can be removed is very small, and/or
(though typically both) the resulting standard errors will be so large
as to deem the reweighted estimate “useless.”</p>
</blockquote>
<p>Tipton, E. (2014). How Generalizable Is Your Experiment? An Index for
Comparing Experimental Samples and Populations. Journal of Educational
and Behavioral Statistics, 39(6), 521–546. <a href="https://doi.org/10.3102/1076998614558486" class="external-link uri">https://doi.org/10.3102/1076998614558486</a></p>
<p>Before using <code><a href="../reference/assess.html">assess()</a></code>, you first must pick a final
sample based on the results from <code><a href="../reference/recruit.html">recruit()</a></code>. After choosing
your sample, you are ready to take the results you obtained from
<code><a href="../reference/stratify.html">stratify()</a></code> and <code><a href="../reference/recruit.html">recruit()</a></code> and use them to
<code><a href="../reference/assess.html">assess()</a></code> the generalizability of your sample data to the
population. Unlike the previous two functions, you cannot take the
output of recruit and plug it directly into <code><a href="../reference/assess.html">assess()</a></code>.
Instead, <code><a href="../reference/assess.html">assess()</a></code> requires the inference population dataset
given to <code><a href="../reference/stratify.html">stratify()</a></code> at the beginning of this process, with
an additional variable indicating whether each unit is in the
sample.</p>
<p>If you did not use the <code><a href="../reference/stratify.html">stratify()</a></code> and
<code><a href="../reference/recruit.html">recruit()</a></code> functions to pick your sample, then you will need
to give <code><a href="../reference/assess.html">assess()</a></code> a dataset of the population that you chose
your sample from, which must include your covariates and a sample
indicator variable.</p>
<p>Returning to our example, recall that our inference population
consists of Texas charter high schools. Therefore, <code><a href="../reference/assess.html">assess()</a></code>
will provide a generalizability index that shows to what extent the
results from the the chosen sample will generalize to all Texas charter
high schools. If you would like to see how the sample may generalize to
data beyond this inference population (e.g. charter schools across the
US), then you may include these additional observations in the
population dataset you give <code><a href="../reference/assess.html">assess()</a></code> - just be sure that
these added units are marked as <strong>not</strong> in the sample.</p>
<p>We can use the recruitment lists stored in <code>rec_output</code>
and the number of units per strata to add a <code>sample</code> variable
to <code>inference_pop</code>. The list for strata <code>n</code> can be
found by running <code>rec_output$recruitment_lists[[n]]</code>. You
will likely add this <code>sample</code> variable manually over time as
you coordinate with each school, but since this is an example, we will
pretend that recruitment was entirely successful.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rec_output</span><span class="op">$</span><span class="va">recruitment_lists</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ncessch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>  <span class="va">rec_output</span><span class="op">$</span><span class="va">recruitment_lists</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ncessch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>,</span>
<span>  <span class="va">rec_output</span><span class="op">$</span><span class="va">recruitment_lists</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ncessch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, </span>
<span>  <span class="va">rec_output</span><span class="op">$</span><span class="va">recruitment_lists</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">ncessch</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inference_pop_sample</span> <span class="op">&lt;-</span> <span class="va">inference_pop</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>sample <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">ncessch</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sample_list</span>,</span>
<span>                          <span class="fl">1</span>,</span>
<span>                          <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we are ready to give the data to the guided <code><a href="../reference/assess.html">assess()</a></code>
function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">assess_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assess.html">assess</a></span><span class="op">(</span><span class="va">inference_pop_sample</span><span class="op">)</span></span></code></pre></div>
<p>First, we will receive this welcome message and be prompted to
indicate the binary variable that encodes sample membership.</p>
<p><img src="assess_fig_1.png" width="550"></p>
<p>We will enter 44 to indicate <code>sample</code>. We see the same
list of variables, except with <code>sample</code> missing, and we are
asked to select covariations. We must specify the variables that we hope
are generalizable. These are the same variables we first used to
stratify the population. In this case, we will enter 30 33 39 43, the
same variables we used for stratifying (these are different numbers from
stratify because <code><a href="../reference/stratify.html">stratify()</a></code> removes the id variable
<code>ncessch</code>).</p>
<p><img src="assess_fig_2.png" width="550"></p>
<p>After entering this information, you will be asked two questions:
first, if the sample data is disjoint from the population, and second,
if the population data should be trimmed.</p>
<p><img src="assess_fig_3.png" width="550"></p>
<p>For this first question, the data is <strong>not</strong> disjoint
only if the sample is <strong>not</strong> a direct subset of the
population. For example, this sample would be disjoint with the
population if the sample only included schools in Texas, but the target
population includes schools in New Hampshire. Also, every unit in the
sample must have come from the population. If that is untrue for even
one unit, then the data is disjoint. In our example, the sample is an
exact subset of the population, and is <strong>not</strong> disjoint
from the population.</p>
<p>The second question relates to how well your chosen sample represents
the population. Since the nature of research studies makes it impossible
to do a simple random sample (SRS), you will invariably find that the
units in the population have unequal probabilities of being in the
sample. Sometimes there are units in the population with zero
probability of being in the sample. This results in coverage error
(Tipton, 2014), where the sample only represents a portion of the
population. As a default, you should trim the population. When you do
so, the final result of <code><a href="../reference/assess.html">assess()</a></code> will include the number of
units trimmed from the population, and a generalizability index based
only on the portion of the population represented in the sample. There
is no solution to coverage error. The best route to avoid it is by
choosing your sample carefully with the same methods used in
<code><a href="../reference/stratify.html">stratify()</a></code> and <code><a href="../reference/recruit.html">recruit()</a></code>, and then
<code><a href="../reference/assess.html">assess()</a></code> any possible samples to find coverage error early
on.</p>
<p>After answering these questions, the function will ask for the method
for estimating the generalizability index.</p>
<p><img src="assess_fig_4.png" width="550"></p>
<p>Logistic Regression is the default method. Unless you have specific
technical reasons for choosing the other two options, we highly suggest
you stick with the default.</p>
<p>After this, the function ends with providing the generalizability
index. You can see this index and more details when you
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> the generalizer object.</p>
<p><img src="assess_fig_5.png" width="550"></p>
<p>To interpret the generalizeR index, please refer to the information
at the beginning of the <code><a href="../reference/assess.html">assess()</a></code> tutorial.</p>
<p>If you run <code>summary(assess_output)</code>, you will see the
following tables in the console and Plots pane.</p>
<p><img src="assess_fig_6.png" width="550"></p>
<p><img src="assess_fig_7.png" width="550"></p>
<p>You can also see a nicer version of the covariate table by running
<code>assess_output$covariate_kable</code>.</p>
<p><img src="assess_fig_11.png" width="550"></p>
<p>The summary reminds us of which covariates we used, our estimation
method, and how much of the population was trimmed, if any. It also
compares the distribution of the propensity scores (the logistic
regression probabilities of a unit being in the sample) for units in the
sample vs. the population. The trimmed units are the units in the
population that are not represented in the sample; in this case, the
units with propensity scores less than roughly -2.05. Additionally, it
provides a comparison for each covariate. Ideally, we would like to see
the ASMD &lt; 0.25.</p>
</div>
<div class="section level3">
<h3 id="unguided-2">Unguided<a class="anchor" aria-label="anchor" href="#unguided-2"></a>
</h3>
<p>We highly suggest that you only use the unguided version after you
have used the guided version multiple times and feel that you have a
clear understanding of what the function does. If you want to use the
guided version, but are uncertain about what each argument is supposed
to be, please run <code><a href="../reference/assess.html">?assess</a></code> in the console or check the
reference page.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-4-weighting">Step 4: Weighting<a class="anchor" aria-label="anchor" href="#step-4-weighting"></a>
</h2>
<p>The main purpose of this function is to weight the sample so it can
provide an unbiased estimate of the total average treatment effect
(TATE). If the data is disjoint, then the weighting method is inverse
odds; if the data is <strong>not</strong> disjoint, then the weighting
method is inverse probability. There is no guided version for this
function. Check the function documentation to see which arguments
<code><a href="../reference/weighting.html">weighting()</a></code> takes - they are the same arguments that
<code><a href="../reference/assess.html">assess()</a></code> takes for the most part.</p>
<p>I will run <code><a href="../reference/weighting.html">weighting()</a></code> with the
<code>inference_pop</code>, which I created for <code><a href="../reference/assess.html">assess()</a></code>.
You also have the option to add in an <code>outcome</code> and
<code>treatment_indicator</code> variable, in which case, weighting will
also calculate the weighted and unweighted TATE. You must include those
variables if you want the weighted TATE. Note that you can only include
those variables after the study has finished.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selection_covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"total"</span>, <span class="st">"pct_black_or_african_american"</span>, <span class="st">"pct_white"</span>, <span class="st">"pct_female"</span>, <span class="st">"pct_free_and_reduced_lunch"</span><span class="op">)</span></span>
<span><span class="va">weighting_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weighting.html">weighting</a></span><span class="op">(</span><span class="va">inference_pop_sample</span>, sample_indicator <span class="op">=</span> <span class="st">"sample"</span>,covariates <span class="op">=</span> <span class="va">selection_covariates</span>, disjoint_data <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>If you do not include <code>outcome</code> and <code>treatment</code>
variables, then running <code>summary(weighting_output)</code> will look
like the following.</p>
<p><img src="assess_fig_8.png" width="550"></p>
<p><img src="assess_fig_9.png" width="550"></p>
<p><img src="assess_fig_10.png" width="550"></p>
<p>As you can see, these results are similar to the results of
<code><a href="../reference/assess.html">assess()</a></code>, with the addition of the histogram describing the
distribution of the weights for each unit.</p>
<p>If you do include the <code>outcome</code> and <code>treatment</code>
variables, then you will also get the following tables instead of
<code>NULL</code> values.</p>
<p><img src="weighting_fig_4.png" width="550"></p>
<p>Here, we can see that the weighted TATE is larger than the unweighted
TATE. Their confidence intervals overlap, so we cannot conclude that
there is a significant difference. We can, however, be confident that
the weighted TATE has less bias than the unweighted TATE.</p>
<p>Lastly, you can see a nicer version of the covariate table by running
<code>weighting_output$covariate_kable</code>.</p>
<p><img src="weighting_fig_5.png" width="550"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nicole Nixon, Tim Ruel, Benjamin Ackerman, Katie Coburn, Beatrice Chao, Beth Tipton.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
